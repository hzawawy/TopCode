package srm578;

import java.util.ArrayList;
import java.util.LinkedList;
import java.util.Queue;

class Node {
	int x,y;
	Node (int X, int Y){
		x = X;
		y = Y;
	}
}

public class GooseInZooDivOne {

	public int count(String[] field, int dist){
		int count = 1;
		boolean[][] visited= new boolean[field.length][field[0].length()];
		for (int i=0; i<field.length; i++)
			for (int j=0; j<field[i].length(); j++)
				visited[i][j]=false;
		
		long sets = 1;
		for (int i=0; i<field.length; i++){
			for (int j=0; j<field[i].length(); j++){
				if ((!visited[i][j]) && (field[i].charAt(j)=='v')){
					Queue<Node> queue = new LinkedList<Node>();
					queue.add(new Node(i,j));
					while (!queue.isEmpty()){
						Node cur = queue.remove();
						for (int k=cur.x; k<=Math.min(cur.x+dist, field.length-1); k++){
							for (int l=cur.y; l<=Math.min(cur.y+dist,field[cur.x].length()-1); l++){
								if ((!visited[k][l]) && (field[k].charAt(l)=='v')){
									visited[k][l]=true;
									queue.add(new Node(k,l));
								}
							}
						}
					}
					sets=(sets*2)%1000000007;
				}
			}
		}
		if (sets==0) return 0;
		count = (int)(sets- 1)%1000000007;
		return count;
	}
	
	public static void main(String[] args) {
		GooseInZooDivOne goose = new GooseInZooDivOne();
		int dist = 3;
		String[] field = 
//			{"v.v", "v.v", "v.v", "...", "v.v"};
			{"v.v..................v............................"
				,".v......v..................v.....................v"
				,"..v.....v....v.........v...............v......v..."
				,".........vvv...vv.v.........v.v..................v"
				,".....v..........v......v..v...v.......v..........."
				,"...................vv...............v.v..v.v..v..."
				,".v.vv.................v..............v............"
				,"..vv.......v...vv.v............vv.....v.....v....."
				,"....v..........v....v........v.......v.v.v........"
				,".v.......v.............v.v..........vv......v....."
				,"....v.v.......v........v.....v.................v.."
				,"....v..v..v.v..............v.v.v....v..........v.."
				,"..........v...v...................v..............v"
				,"..v........v..........................v....v..v..."
				,"....................v..v.........vv........v......"
				,"..v......v...............................v.v......"
				,"..v.v..............v........v...............vv.vv."
				,"...vv......v...............v.v..............v....."
				,"............................v..v.................v"
				,".v.............v.......v.........................."
				,"......v...v........................v.............."
				,".........v.....v..............vv.................."
				,"................v..v..v.........v....v.......v...."
				,"........v.....v.............v......v.v............"
				,"...........v....................v.v....v.v.v...v.."
				,"...........v......................v...v..........."
				,"..........vv...........v.v.....................v.."
				,".....................v......v............v...v...."
				,".....vv..........................vv.v.....v.v....."
				,".vv.......v...............v.......v..v.....v......"
				,"............v................v..........v....v...."
				,"................vv...v............................"
				,"................v...........v........v...v....v..."
				,"..v...v...v.............v...v........v....v..v...."
				,"......v..v.......v........v..v....vv.............."
				,"...........v..........v........v.v................"
				,"v.v......v................v....................v.."
				,".v........v................................v......"
				,"............................v...v.......v........."
				,"........................vv.v..............v...vv.."
				,".......................vv........v.............v.."
				,"...v.............v.........................v......"
				,"....v......vv...........................v........."
				,"....vv....v................v...vv..............v.."
				,".................................................."
				,"vv........v...v..v.....v..v..................v...."
				,".........v..............v.vv.v.............v......"
				,".......v.....v......v...............v............."
				,"..v..................v................v....v......"
				,".....v.....v.....................v.v......v......."};
		System.out.println(goose.count(field, dist));
		// 898961330
		// 291172003
		
	}

}
